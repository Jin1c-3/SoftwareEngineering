"use strict";(self["webpackChunkpleasuretour"]=self["webpackChunkpleasuretour"]||[]).push([[37],{5037:function(t,i,e){e.r(i),e.d(i,{default:function(){return h}});var a=function(){var t=this,i=t._self._c;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"selfOrder","element-loading-background":"#f8f8f8"}},[i("el-row",[i("h2",[t._v("订单信息")]),i("el-divider"),i("div",{staticClass:"row",staticStyle:{width:"100%","justify-content":"space-around","margin-bottom":"20px"}},[i("el-card",{staticStyle:{margin:"0 10px",flex:"1",height:"80px"}},[i("div",{staticClass:"row",staticStyle:{width:"100%","justify-content":"space-around","margin-bottom":"20px"}},[i("i",{staticClass:"el-icon-s-claim icon"}),i("div",{staticClass:"col"},[i("div",[t._v("已完成订单数")]),i("div",{staticStyle:{color:"#409eff","font-size":"20px"}},[t._v(" "+t._s(t.havePay.length)+" ")])])])]),i("el-card",{staticStyle:{margin:"0 10px",flex:"1",height:"80px"}},[i("div",{staticClass:"row",staticStyle:{width:"100%","justify-content":"space-around","margin-bottom":"20px"}},[i("i",{staticClass:"el-icon-s-order icon"}),i("div",{staticClass:"col"},[i("div",[t._v("待支付订单数")]),i("div",{staticStyle:{color:"#409eff","font-size":"20px"}},[t._v(" "+t._s(t.waitPay.length)+" ")])])])]),i("el-card",{staticStyle:{margin:"0 10px",flex:"1",height:"80px"}},[i("div",{staticClass:"row",staticStyle:{width:"100%","justify-content":"space-around","margin-bottom":"20px"}},[i("i",{staticClass:"el-icon-position icon"}),i("div",{staticClass:"col"},[i("div",[t._v("旅程长度")]),i("div",{staticStyle:{color:"#409eff","font-size":"20px"}},[t._v("1000公里")])])])])],1),i("h3",{staticStyle:{color:"#e6a23c"}},[t._v("等待支付")]),i("div",{staticStyle:{color:"#c0c4cc","font-size":"12px","margin-bottom":"10px"}},[t._v(" 目前处于排队等待支付的订单 ")]),t._l(t.waitPay,(function(e,a){return i("el-card",{key:a,staticStyle:{margin:"10px 0",height:"120px",position:"relative"},attrs:{shadow:"hover","body-style":"padding: 10px"}},[i("div",{staticClass:"col"},[i("div",{staticClass:"row",staticStyle:{width:"100%",height:"100px","justify-content":"start"}},[i("div",{staticClass:"el-icon-document-remove wait"}),i("strong",[t._v("订单编号："+t._s(e.orderId))]),i("el-statistic",{staticStyle:{width:"90px",position:"absolute",right:"10px",top:"10px"},attrs:{value:12e5+Date.parse(e.orderTime.toString().slice(0,19)),"time-indices":"",title:"剩余支付时间",format:"HH:mm:ss","value-style":{color:"red"}}},[i("template",{slot:"prefix"},[i("i",{staticClass:"el-icon-timer",staticStyle:{color:"red"}})])],2)],1)]),i("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center"}},[12e5+Date.parse(e.orderTime.toString().slice(0,19))>0?i("el-button",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.pay(e)}}},[t._v("继续支付")]):t._e()],1)])})),i("h3",{staticStyle:{color:"#67c23a"}},[t._v("已支付")]),i("div",{staticStyle:{color:"#c0c4cc","font-size":"12px","margin-bottom":"10px"}},[t._v(" 历史记录已支付的订单 ")]),t._l(t.havePay,(function(e,a){return i("el-card",{key:a,staticStyle:{margin:"10px 0",height:"120px",position:"relative"},attrs:{shadow:"hover","body-style":"padding: 10px"}},[i("div",{staticClass:"col"},[i("div",{staticClass:"row",staticStyle:{width:"100%",height:"100px","justify-content":"start"}},[i("div",{staticClass:"el-icon-document-checked have"}),i("strong",[t._v("订单编号："+t._s(e.orderId))])])]),i("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center"}},[i("el-button",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.getDetail(e)}}},[t._v("查看详情")])],1)])}))],2),i("el-dialog",{attrs:{title:"订单详情",visible:t.dialog},on:{"update:visible":function(i){t.dialog=i}}},["飞机"==t.details.vehicleType?i("div",[i("div",{staticClass:"col"},[i("div",[t._v("航班："+t._s(t.details.info[0].flightId))]),i("div",[t._v("订单编号："+t._s(t.details.info[0].orderId))]),i("div",[t._v(" 完成时间："+t._s(t.details.info[0].flightStartTime.toString().slice(0,5))+" - "+t._s(t.details.info[0].flightEndTime.toString().slice(0,5))+" ")]),i("div",[t._v(" 航线："+t._s(t.details.info[0].flightStartPort)+" -"+t._s(t.details.info[0].flightEndPort)+" ")]),i("div",{staticClass:"row"},[i("div",[t._v("乘客")]),t._l(t.details.info,(function(e,a){return i("div",{key:a},[t._v(" "+t._s(e.passengerName)+", ")])}))],2),i("div",[t._v("座位："+t._s(t.details.info[0].seatType))]),i("div",[t._v(" 票价："+t._s(t.details.info[0].flightPrice*t.details.info.length)+" ")])])]):"火车"==t.details.vehicleType?i("div",[i("div",{staticClass:"col"},[i("div",[t._v("车次："+t._s(t.details.info[0].trainNumberId))]),i("div",[t._v("订单编号："+t._s(t.details.info[0].orderId))]),i("div",[t._v(" 完成时间："+t._s(t.details.info[0].trainTicketStartTime.toString().slice(0,5))+" - "+t._s(t.details.info[0].trainTicketEndTime.toString().slice(0,5))+" ")]),i("div",[t._v(" 线路："+t._s(t.details.info[0].trainStartStation)+" -"+t._s(t.details.info[0].trainEndStation)+" ")]),i("div",{staticClass:"row"},[i("div",[t._v("乘客")]),t._l(t.details.info,(function(e,a){return i("div",{key:a},[t._v(" "+t._s(e.passengerName)+", ")])}))],2),i("div",[t._v("座位："+t._s(t.details.info[0].seatType))]),i("div",[t._v(" 票价："+t._s(t.details.info[0].trainPrice*t.details.info.length)+" ")])])]):t._e()]),i("div",{ref:"alipay",domProps:{innerHTML:t._s(t.alipay)}})],1)},s=[],o=e(4161),l=e(8568),r=e(3822),d={data(){return{loading:!0,dialog:!1,orderList:[],havePay:"",waitPay:"",details:"",alipay:""}},methods:{...(0,r.nv)("login",{getInfo:"getInfo"}),getOrders(){(0,o.Z)({method:"get",url:`${l.Z.url}/whole-order/getOrder`,headers:{token:localStorage.getItem("token")},params:{usrId:this.$store.state.user.userForm.usrId}}).then((t=>{console.log(t.data.data),this.orderList=t.data.data,this.havePay=this.orderList.filter((t=>"已支付"==t.orderStatus)),this.waitPay=this.orderList.filter((t=>"未支付"==t.orderStatus))})).catch((t=>{console.log(t)}))},details(){this.dialog=!0},getDetail(t){let i=l.Z.url+("飞机"==t.vehicleType?"/aircraft/query-aircraft-ticket":"/train/query-train-ticket");(0,o.Z)({method:"get",url:i,headers:{token:localStorage.getItem("token")},params:{orderId:t.orderId}}).then((i=>{console.log(i.data.data),this.details=i.data.data,this.details={info:this.details,vehicleType:t.vehicleType},console.log(this.details),this.dialog=!0})).catch((t=>{console.log(t)}))},pay(t){(0,o.Z)({method:"get",url:`${l.Z.url}/whole-order/alipayContinue`,headers:{token:localStorage.getItem("token")},params:{orderId:t.orderId}}).then((t=>{this.alipay=t.data.data,this.$nextTick((()=>{this.$refs.alipay.children[0].submit()}))})).catch((t=>{console.log(t)}))}},activated(){this.getInfo(this),this.getOrders(),setTimeout((()=>{this.loading=!1}),1e3)},deactivated(){console.log("deactivated"),this.loading=!0}},n=d,c=e(1001),v=(0,c.Z)(n,a,s,!1,null,"d4acae26",null),h=v.exports}}]);
//# sourceMappingURL=37.2f76706a.js.map