"use strict";(self["webpackChunkpleasuretour"]=self["webpackChunkpleasuretour"]||[]).push([[930],{930:function(e,s,t){t.r(s),t.d(s,{default:function(){return m}});var a=function(){var e=this,s=e._self._c;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{id:"selfPassenger","element-loading-background":"#f8f8f8"}},[s("el-row",[s("h2",[e._v("乘客")]),s("el-divider"),e._l(e.passengerList,(function(t,a){return s("el-card",{key:a,staticStyle:{margin:"10px 0",height:"110px",position:"relative"},attrs:{shadow:"hover","body-style":"padding: 10px"}},[s("div",{staticClass:"row"},[s("i",{staticClass:"el-icon-user-solid"}),s("div",[s("div",[s("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v("乘客姓名：")]),s("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.passengerName)+" ")])]),s("div",{staticStyle:{"margin-top":"10px"}},[s("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v("乘客身份证号：")]),s("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.passengerId)+" ")])]),s("div",{staticStyle:{"margin-top":"10px"}},[s("span",{staticStyle:{"font-weight":"bold",color:"#409eff"}},[e._v("乘客电话：")]),s("span",{staticStyle:{"font-size":"15px"}},[e._v(e._s(t.phoneNumber)+" ")])])])]),s("el-popconfirm",{attrs:{title:"确定删除该乘客信息？"},on:{confirm:function(s){return e.deletePassenger(t)}}},[s("el-button",{staticClass:"el-icon-close close",attrs:{slot:"reference",type:"text"},slot:"reference"})],1)],1)})),s("div",{staticStyle:{width:"100%",display:"flex","justify-content":"center","align-items":"center"}},[s("el-button",{staticClass:"el-icon-plus",staticStyle:{"margin-top":"10px","font-size":"20px"},attrs:{type:"text"},on:{click:e.addPassenger}},[e._v(" 添加乘客 ")])],1)],2),s("el-dialog",{attrs:{title:"乘客信息",visible:e.addDialog,"append-to-body":""},on:{"update:visible":function(s){e.addDialog=s}}},[s("el-form",{ref:"passengerForm",attrs:{"label-width":"120px","label-position":"left",model:e.passengerForm,rules:e.rules}},[s("el-form-item",{attrs:{label:"乘客姓名",prop:"passengerName"}},[s("el-input",{staticStyle:{width:"60%"},model:{value:e.passengerForm.passengerName,callback:function(s){e.$set(e.passengerForm,"passengerName",s)},expression:"passengerForm.passengerName"}})],1),s("el-form-item",{attrs:{label:"乘客身份证号",prop:"passengerIdCard"}},[s("el-input",{staticStyle:{width:"60%"},model:{value:e.passengerForm.passengerIdCard,callback:function(s){e.$set(e.passengerForm,"passengerIdCard",s)},expression:"passengerForm.passengerIdCard"}})],1),s("el-form-item",{attrs:{label:"乘客电话",prop:"phoneNumber"}},[s("el-input",{staticStyle:{width:"60%"},model:{value:e.passengerForm.phoneNumber,callback:function(s){e.$set(e.passengerForm,"phoneNumber",s)},expression:"passengerForm.phoneNumber"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(s){e.addDialog=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)],1)],1)},r=[],o=t(8568),n=t(4161),i=t(3822),l={data(){return{loading:!0,passenger:8,addDialog:!1,passengerList:[],passengerForm:{passengerName:"",passengerIdCard:"",phoneNumber:""},rules:{passengerName:[{required:!0,message:"请输入乘客姓名",trigger:"blur"}],passengerIdCard:[{required:!0,message:"请输入乘客身份证号",trigger:"blur"},{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,message:"身份证号码格式不正确",trigger:"blur"}],phoneNumber:[{required:!0,message:"请输入乘客电话",trigger:"blur"}]}}},methods:{...(0,i.nv)("login",{getInfo:"getInfo"}),getPassegers(){(0,n.Z)({url:`${o.Z.url}/passenger/findPsgByUsrId`,headers:{token:localStorage.getItem("token")},params:{usrId:this.$store.state.user.userForm.usrId}}).then((e=>{200==e.data.code?(console.log(e.data.data),this.passengerList=e.data.data):this.$message({message:e.data.message,type:"error",duration:1e3})})).catch((e=>{this.$message({message:e,type:"error",duration:1e3})}))},addPassenger(){this.addDialog=!0},add(){this.$refs["passengerForm"].validate((e=>{e?(0,n.Z)({url:`${o.Z.url}/passenger/addPassenger`,method:"post",headers:{token:localStorage.getItem("token")},data:{usrId:this.$store.state.user.userForm.usrId,passengerName:this.passengerForm.passengerName,passengerId:this.passengerForm.passengerIdCard,phoneNumber:this.passengerForm.phoneNumber,passengerType:"飞机"}}).then((e=>{200==e.data.code?(this.$message({message:e.data.message,type:"success",duration:1e3}),this.addDialog=!1,this.getPassegers()):this.$message({message:e.data.message,type:"error",duration:1e3})})).catch((e=>{this.$message({message:e,type:"error",duration:1e3})})):this.$message({message:"请检查输入是否正确",type:"error",duration:1e3})}))},deletePassenger(e){(0,n.Z)({url:`${o.Z.url}/passenger/deletePassenger`,method:"delete",headers:{token:localStorage.getItem("token")},data:{usrId:this.$store.state.user.userForm.usrId,passengerName:e.passengerName,passengerId:e.passengerId,phoneNumber:e.phoneNumber}}).then((e=>{200==e.data.code?(this.$message({message:e.data.message,type:"success",duration:1e3}),this.getPassegers()):this.$message({message:e.data.message,type:"error",duration:1e3})})).catch((e=>{this.$message({message:e,type:"error",duration:1e3})}))}},activated(){this.getInfo(this),this.getPassegers(this),setTimeout((()=>{this.loading=!1}),1e3)},deactivated(){console.log("deactivated"),this.loading=!0}},d=l,g=t(1001),p=(0,g.Z)(d,a,r,!1,null,"11a723a7",null),m=p.exports}}]);
//# sourceMappingURL=930.a515f87e.js.map